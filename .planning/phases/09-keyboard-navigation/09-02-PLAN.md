---
phase: 09-keyboard-navigation
plan: 02
type: execute
---

<objective>
Implement arrow key navigation for Tabs component.

Purpose: Enable keyboard users to navigate between tabs using arrow keys per WAI-ARIA Tabs pattern (WCAG 2.1.1). This is a P0 Critical accessibility gap.
Output: Tabs with Left/Right arrow navigation, Home/End support, and proper focus management.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 8 established ARIA patterns for Tabs:
@.planning/phases/08-aria-semantic-markup/08-04-SUMMARY.md

# Existing keyboard patterns:
@.planning/phases/04-ux-polish/04-02-SUMMARY.md

# Component to modify:
@components/tabs.go

# Reference for keyboard handling:
@components/dropdown.go (arrow key navigation pattern)

**Tech stack available:** Go/WASM, syscall/js
**Established patterns:**
- Roving tabindex (active tab tabindex=0, others tabindex=-1)
- Arrow key navigation with wrapping
- crypto.randomUUID() for unique IDs

**Constraining decisions:**
- Phase 08-04: Tabs has role="tablist", role="tab", role="tabpanel", aria-selected, roving tabindex
- Phase 04-02: Arrow navigation wraps at boundaries

**Issues being addressed:**
- P0 #3: Tabs no arrow key navigation
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Left/Right arrow key navigation to Tabs</name>
  <files>components/tabs.go</files>
  <action>
Implement horizontal arrow key navigation per WAI-ARIA Tabs pattern:

1. Add `keyHandler js.Func` field to Tabs struct for cleanup
2. In NewTabs(), after creating tab buttons, set up keydown handler on the tablist (tabNav element):

   ```
   keyHandler := js.FuncOf(func(this js.Value, args []js.Value) any {
       event := args[0]
       key := event.Get("key").String()

       switch key {
       case "ArrowRight":
           event.Call("preventDefault")
           // Move to next tab, wrap to first if at end
           nextIdx := (t.activeIndex + 1) % len(t.tabButtons)
           t.SetActive(nextIdx)
           t.tabButtons[nextIdx].Call("focus")
       case "ArrowLeft":
           event.Call("preventDefault")
           // Move to previous tab, wrap to last if at start
           prevIdx := t.activeIndex - 1
           if prevIdx < 0 {
               prevIdx = len(t.tabButtons) - 1
           }
           t.SetActive(prevIdx)
           t.tabButtons[prevIdx].Call("focus")
       }
       return nil
   })
   ```

3. Add the keydown listener to tabNav element
4. Store keyHandler for potential cleanup

Note: WAI-ARIA pattern activates tab on arrow key press (automatic activation), which is what we implement here.
  </action>
  <verify>
Manual test: Focus first tab, press Right arrow - second tab activates and receives focus.
Press Right on last tab - first tab activates (wraps). Left arrow works in reverse.
  </verify>
  <done>Left/Right arrows navigate between tabs with wrapping, activating and focusing the target tab</done>
</task>

<task type="auto">
  <name>Task 2: Add Home/End key support to Tabs</name>
  <files>components/tabs.go</files>
  <action>
Add Home and End key support to the existing keydown handler:

1. Extend the switch statement in the keyHandler:

   ```
   case "Home":
       event.Call("preventDefault")
       t.SetActive(0)
       t.tabButtons[0].Call("focus")
   case "End":
       event.Call("preventDefault")
       lastIdx := len(t.tabButtons) - 1
       t.SetActive(lastIdx)
       t.tabButtons[lastIdx].Call("focus")
   ```

2. Ensure the handler is on the tabNav (tablist) element, not individual tabs

This completes the WAI-ARIA Tabs keyboard pattern: Arrow keys for adjacent, Home/End for extremes.
  </action>
  <verify>
Manual test: Focus any tab, press Home - first tab activates and receives focus.
Press End - last tab activates and receives focus.
  </verify>
  <done>Home key jumps to first tab, End key jumps to last tab</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Right arrow moves to next tab
- [ ] Left arrow moves to previous tab
- [ ] Right arrow on last tab wraps to first
- [ ] Left arrow on first tab wraps to last
- [ ] Home key activates first tab
- [ ] End key activates last tab
- [ ] Focus follows the active tab
- [ ] Tab key moves focus out of tablist (not between tabs)
- [ ] `go build ./...` succeeds
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Tabs keyboard navigation meets WAI-ARIA Tabs pattern
- Arrow keys activate and focus tabs with wrapping
</success_criteria>

<output>
After completion, create `.planning/phases/09-keyboard-navigation/09-02-SUMMARY.md`
</output>
