---
phase: 04-ux-polish
plan: 03
type: execute
---

<objective>
Create a reusable ConfirmDialog component for destructive action confirmations.

Purpose: Provide a standard confirmation pattern for delete operations, bulk actions, and other destructive operations.
Output: ConfirmDialog component with flexible API and integration with bulk actions.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-table-enhancements/03-04-SUMMARY.md

# Key files:
@components/modal.go
@components/table.go  # Bulk action bar that could use confirmation
@example/app/main.go  # Lines 224-235 show existing modal pattern in feedbackDemo()

**Tech available:** Modal component with Title, Content, Footer, CloseOnEsc
**Established patterns:**
- Modal with confirm/cancel buttons in footer (feedbackDemo lines 224-235)
- Button components for Confirm/Cancel styling
- Toast for success/error feedback

**Constraining decisions:**
- Phase 03-04: Bulk action bar has configurable actions (OnBulkAction callback)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ConfirmDialog component</name>
  <files>components/confirm_dialog.go</files>
  <action>
Create a new file components/confirm_dialog.go with a reusable confirmation dialog:

```go
//go:build js && wasm

package components

import "syscall/js"

// ConfirmDialogVariant defines the visual style of the dialog
type ConfirmDialogVariant string

const (
    ConfirmDefault ConfirmDialogVariant = "default"
    ConfirmDanger  ConfirmDialogVariant = "danger"
    ConfirmWarning ConfirmDialogVariant = "warning"
)

// ConfirmDialogProps configures a ConfirmDialog
type ConfirmDialogProps struct {
    Title         string               // Dialog title
    Message       string               // Confirmation message
    ConfirmText   string               // Confirm button text (default: "Confirm")
    CancelText    string               // Cancel button text (default: "Cancel")
    Variant       ConfirmDialogVariant // Visual style (affects confirm button)
    OnConfirm     func()               // Called when confirmed
    OnCancel      func()               // Called when cancelled (optional)
}

// ConfirmDialog wraps Modal for confirmation workflows
type ConfirmDialog struct {
    modal *Modal
    props ConfirmDialogProps
}
```

Implementation:
1. NewConfirmDialog(props) creates a Modal internally
2. Set defaults: ConfirmText="Confirm", CancelText="Cancel", Variant=ConfirmDefault
3. Build footer with Cancel (secondary) and Confirm buttons
4. Confirm button variant based on props.Variant:
   - ConfirmDefault: ButtonPrimary
   - ConfirmDanger: ButtonDanger
   - ConfirmWarning: ButtonWarning
5. Cancel calls modal.Close() then props.OnCancel if set
6. Confirm calls modal.Close() then props.OnConfirm
7. Expose Open(), Close(), Element() methods

Add convenience function:
```go
// Confirm is a shortcut for simple confirmation dialogs
func Confirm(title, message string, onConfirm func()) *ConfirmDialog {
    return NewConfirmDialog(ConfirmDialogProps{
        Title:     title,
        Message:   message,
        OnConfirm: onConfirm,
    })
}

// ConfirmDanger is a shortcut for dangerous action confirmation
func ConfirmDanger(title, message string, onConfirm func()) *ConfirmDialog {
    return NewConfirmDialog(ConfirmDialogProps{
        Title:       title,
        Message:     message,
        ConfirmText: "Delete",
        Variant:     ConfirmDanger,
        OnConfirm:   onConfirm,
    })
}
```
  </action>
  <verify>
1. Build: `cd example && make build`
2. Verify no compile errors
  </verify>
  <done>
- ConfirmDialog component exists
- Supports default, danger, warning variants
- Convenience functions Confirm() and ConfirmDanger() exist
  </done>
</task>

<task type="auto">
  <name>Task 2: Add ConfirmDialog demo to component showcase</name>
  <files>example/app/main.go</files>
  <action>
Update feedbackDemo() in example/app/main.go to showcase ConfirmDialog:

1. Create a confirm dialog instance in feedbackDemo():
```go
// Confirmation dialogs
confirmDialog := components.Confirm("Confirm Action",
    "Are you sure you want to proceed?",
    func() {
        components.Toast("Action confirmed!", components.ToastSuccess)
    },
)

dangerDialog := components.ConfirmDanger("Delete Item",
    "This action cannot be undone. Are you sure you want to delete this item?",
    func() {
        components.Toast("Item deleted!", components.ToastError)
    },
)
```

2. Add a new Section("Confirmation Dialogs") with buttons to open each dialog type:
```go
components.Section("Confirmation Dialogs",
    components.Div("flex gap-2",
        components.PrimaryButton("Confirm Dialog", func() { confirmDialog.Open() }),
        components.Button(components.ButtonProps{
            Text:    "Danger Confirm",
            Variant: components.ButtonDanger,
            OnClick: func() { dangerDialog.Open() },
        }),
    ),
    confirmDialog.Element(),
    dangerDialog.Element(),
),
```

3. Keep the existing Modal section as-is - ConfirmDialog is separate.
  </action>
  <verify>
1. Build: `cd example && make build`
2. Run: `cd example && make run`
3. Navigate to Components > Feedback tab
4. Click "Confirm Dialog" - shows standard confirmation
5. Click confirm - closes and shows toast
6. Click "Danger Confirm" - shows red confirm button
7. Cancel buttons work on both
  </verify>
  <done>
- ConfirmDialog demos visible in Feedback tab
- Standard and danger variants demonstrated
- Confirm and Cancel both work correctly
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>ConfirmDialog component with variants and demo integration</what-built>
  <how-to-verify>
    1. Run: `cd example && make run`
    2. Navigate to Components > Feedback tab
    3. Scroll to "Confirmation Dialogs" section
    4. Click "Confirm Dialog" button:
       - Modal should appear with title "Confirm Action"
       - Blue "Confirm" button, gray "Cancel" button
       - Click Confirm - shows success toast
    5. Click "Danger Confirm" button:
       - Modal should appear with title "Delete Item"
       - Red "Delete" button, gray "Cancel" button
       - Click Cancel - closes without toast
    6. Verify Escape key closes both dialogs
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd example && make build` succeeds
- [ ] ConfirmDialog component exists with variants
- [ ] Demo works in component showcase
- [ ] User has verified dialogs visually
</verification>

<success_criteria>
- All tasks completed including checkpoint approval
- ConfirmDialog supports default, danger, warning variants
- Demo integrated into example app
- Dialogs are keyboard-accessible (Escape to close)
</success_criteria>

<output>
After completion, create `.planning/phases/04-ux-polish/04-03-SUMMARY.md`
</output>
