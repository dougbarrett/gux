---
phase: 03-table-enhancements
plan: 04
type: execute
---

<objective>
Add bulk selection with checkbox column and action bar to the Table component.

Purpose: Enable users to select multiple rows and perform bulk actions on them.
Output: Table component with row selection checkboxes, select-all, and bulk action bar.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan context
@.planning/phases/03-table-enhancements/03-03-SUMMARY.md

# Source files
@components/table.go
@components/checkbox.go

**Tech stack available:** Go WASM, syscall/js, Tailwind CSS
**Established patterns:** Props struct + NewXxx constructor + Element() method
**Key insight:** Checkbox component already exists with checked state management
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add selection state and checkbox column</name>
  <files>components/table.go</files>
  <action>
    1. Add selection configuration to TableProps:
       - `Selectable bool` - enables row selection
       - `RowKey string` - unique identifier field in data (default "id")
       - `OnSelectionChange func(selectedKeys []any)` - callback when selection changes
    2. Add selection state to Table struct:
       - `selectedKeys map[any]bool` - set of selected row keys
       - `selectAllCheckbox js.Value` - reference to header checkbox
    3. Modify header rendering when Selectable=true:
       - Prepend checkbox column header with select-all checkbox
       - Checkbox should be indeterminate when some (not all) rows selected
    4. Modify row rendering when Selectable=true:
       - Prepend checkbox cell to each row
       - Wire checkbox change to toggle selection state
       - Highlight selected rows with background color
    5. Implement select-all logic:
       - If none selected → select all visible rows
       - If some/all selected → deselect all
       - Update individual checkboxes when select-all toggled
  </action>
  <verify>Build passes: `cd example && GOOS=js GOARCH=wasm go build -o ../dist/app.wasm ./app`</verify>
  <done>Checkbox column appears when Selectable=true, rows can be selected, select-all works</done>
</task>

<task type="auto">
  <name>Task 2: Add selection API methods</name>
  <files>components/table.go</files>
  <action>
    1. Add selection methods to Table:
       - `SelectedKeys() []any` - get currently selected row keys
       - `SelectedRows() []map[string]any` - get selected row data
       - `SelectAll()` - select all visible rows
       - `ClearSelection()` - deselect all rows
       - `SetSelection(keys []any)` - set selection programmatically
       - `IsSelected(key any) bool` - check if row is selected
    2. Ensure selection persists correctly:
       - When data changes via SetData, clear selection
       - When filter changes, update selection to only include visible rows
       - When page changes, selection should persist across pages
    3. Update checkbox visual states when selection changes programmatically
    4. Call OnSelectionChange callback whenever selection state changes
  </action>
  <verify>Build passes and selection API works correctly</verify>
  <done>Selection API complete, selection persists correctly across interactions</done>
</task>

<task type="auto">
  <name>Task 3: Add bulk action bar</name>
  <files>components/table.go</files>
  <action>
    1. Add bulk action configuration to TableProps:
       - `BulkActions []BulkAction` - available bulk actions
    2. Define BulkAction struct:
       - `Label string` - button text
       - `Icon string` - optional emoji icon
       - `Variant string` - button style (primary/danger/secondary)
       - `OnExecute func(selectedKeys []any)` - action handler
    3. Create bulk action bar component:
       - Appears above table when rows are selected
       - Shows: "{N} items selected" text + action buttons + "Clear selection" link
       - Animate in/out with fade transition
       - Style: bg-blue-50 dark:bg-blue-900/30 with padding and rounded corners
    4. Wire action buttons to call OnExecute with selected keys
    5. Position: between filter input (if exists) and table
  </action>
  <verify>Build passes and bulk action bar appears when rows selected</verify>
  <done>Bulk action bar shows with selection count and action buttons, actions execute correctly</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd example && GOOS=js GOARCH=wasm go build -o ../dist/app.wasm ./app` succeeds
- [ ] Checkbox column appears for selectable tables
- [ ] Individual row selection works
- [ ] Select-all checkbox works (including indeterminate state)
- [ ] Bulk action bar appears when rows selected
- [ ] Bulk actions receive correct selected keys
- [ ] Selection works correctly with filter, sort, and pagination
</verification>

<success_criteria>

- All 3 tasks completed
- All verification checks pass
- No Go errors
- Selection + bulk actions integrate with filter/sort/pagination
- Phase 3 complete
</success_criteria>

<output>
After completion, create `.planning/phases/03-table-enhancements/03-04-SUMMARY.md`

Include in summary:
- Full table enhancement feature set complete
- Ready for Phase 4: UX Polish
</output>
