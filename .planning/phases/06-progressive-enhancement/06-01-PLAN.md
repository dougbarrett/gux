---
phase: 06-progressive-enhancement
plan: 01
type: execute
domain: go-wasm
---

<objective>
Create ConnectionStatus component for visual WebSocket/connection state indication.

Purpose: Provide users with real-time feedback on their connection state, especially important for real-time database applications.
Output: ConnectionStatus component with dot/badge/text variants, integrated with WebSocketStore.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summary (affects this phase):
@.planning/phases/04-ux-polish/04-02-SUMMARY.md

# Existing WebSocket state infrastructure:
@state/websocket.go

# Component patterns to follow:
@components/badge.go
@components/avatar.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ConnectionStatus component</name>
  <files>components/connection_status.go</files>
  <action>
Create ConnectionStatus component with:
- ConnectionStatusProps: Variant (dot, badge, text, full), Size (sm, md, lg), Labels map for state text
- Visual states: Connecting (yellow/amber pulse), Connected (green), Disconnecting (yellow), Disconnected (red)
- ConnectionStatus(props) - main component
- ConnectionStatusDot(size) - minimal dot indicator
- ConnectionStatusBadge() - badge with text
- ConnectionStatusFull() - full status with icon and message

Use existing patterns:
- Follow Badge component structure for variants
- Use Tailwind animate-pulse for connecting state
- Support dark mode (dark:bg-* classes)
- ARIA live region for accessibility (aria-live="polite")

Colors:
- Connecting: bg-yellow-400 animate-pulse
- Connected: bg-green-500
- Disconnecting: bg-yellow-500
- Disconnected: bg-red-500
  </action>
  <verify>go build -o /dev/null ./components/connection_status.go compiles without errors (use GOOS=js GOARCH=wasm)</verify>
  <done>ConnectionStatus component with all variants compiles, supports WebSocketState constants, has dark mode and accessibility support</done>
</task>

<task type="auto">
  <name>Task 2: Integrate with WebSocketStore and example app</name>
  <files>components/connection_status.go, example/app/main.go</files>
  <action>
Add reactive binding:
- Add BindToWebSocket(store *state.WebSocketStore) method that subscribes to store changes
- Auto-update component when WebSocket state changes
- Add SetState(state WebSocketState) method for manual state control

Integrate with example app:
- Add ConnectionStatus to Header (near user menu, left of action buttons)
- Use ConnectionStatusDot variant with tooltip showing full state
- Bind to any existing WebSocket connection in the example app (or create mock state demo)
- Add keyboard shortcut info in tooltip: "Connection status" + current state

Follow established patterns:
- Header integration pattern from 01-02 (bell icon, user avatar, action buttons order)
- Tooltip pattern for status details
  </action>
  <verify>cd example && GOOS=js GOARCH=wasm go build -o main.wasm ./app/ succeeds, run app and verify ConnectionStatus appears in header</verify>
  <done>ConnectionStatus reactively bound to WebSocketStore, visible in example app header, shows correct state colors and tooltip</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd example && GOOS=js GOARCH=wasm go build -o main.wasm ./app/` succeeds
- [ ] ConnectionStatus component renders with correct colors for each state
- [ ] Dark mode colors work correctly
- [ ] Tooltip shows state details
- [ ] ARIA live region announces state changes
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript/Go errors
- ConnectionStatus component follows established patterns
- Reactive binding works with WebSocketStore
</success_criteria>

<output>
After completion, create `.planning/phases/06-progressive-enhancement/06-01-SUMMARY.md` using template from ./summary.md
</output>
