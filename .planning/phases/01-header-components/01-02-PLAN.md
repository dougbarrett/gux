---
phase: 01-header-components
plan: 02
type: execute
---

<objective>
Integrate UserMenu and NotificationCenter into Header component and showcase in example app.

Purpose: Wire up the new header components and demonstrate their usage with sample data.
Output: Enhanced Header with user/notification slots, working example in the demo app.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-header-components/01-01-SUMMARY.md

# Files to modify:
@components/header.go
@components/layout.go
@example/app/main.go

**Prior plan outputs:** UserMenu and NotificationCenter components created
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend Header component for UserMenu and NotificationCenter</name>
  <files>components/header.go, components/layout.go</files>
  <action>
Update Header to support optional UserMenu and NotificationCenter slots.

Changes to HeaderProps:
- Add UserMenu *UserMenu field (optional)
- Add NotificationCenter *NotificationCenter field (optional)

Changes to NewHeader:
1. In the actions area (actionsEl), before existing action buttons:
   - If props.NotificationCenter != nil, append its Element()
   - If props.UserMenu != nil, append its Element()
2. Add gap between notification/user elements: wrap in a div with "flex items-center gap-3"
3. Keep existing action buttons after the new slots

Changes to Header struct:
- Add userMenu *UserMenu field
- Add notificationCenter *NotificationCenter field
- Add getter methods: UserMenu() and NotificationCenter()

Update Layout:
- LayoutProps.Header already contains HeaderProps, no changes needed to Layout itself
- The header is already passed through correctly

Preserve all existing functionality. The new slots are optional - Header works without them.
  </action>
  <verify>go build ./components/... compiles, existing functionality preserved</verify>
  <done>Header accepts optional UserMenu and NotificationCenter, displays them in actions area, getter methods available</done>
</task>

<task type="auto">
  <name>Task 2: Add UserMenu and NotificationCenter to example app</name>
  <files>example/app/main.go</files>
  <action>
Update the example app to demonstrate the new header components.

1. Create UserMenu instance with sample data:
```go
userMenu := components.NewUserMenu(components.UserMenuProps{
    Name:  "Admin User",
    Email: "admin@example.com",
    OnProfile: func() {
        components.Toast("Profile clicked", components.ToastInfo)
    },
    OnSettings: func() {
        router.Navigate("/settings")
    },
    OnLogout: func() {
        components.Toast("Logged out", components.ToastSuccess)
    },
})
```

2. Create NotificationCenter with sample notifications:
```go
notifications := []components.Notification{
    {ID: "1", Title: "New Post Created", Message: "A new post 'Hello World' was published", Time: "2 min ago", Type: "success"},
    {ID: "2", Title: "System Update", Message: "Version 2.0 is now available", Time: "1 hour ago", Type: "info"},
    {ID: "3", Title: "Warning", Message: "Storage is almost full", Time: "3 hours ago", Type: "warning", Read: true},
}

notificationCenter := components.NewNotificationCenter(components.NotificationCenterProps{
    Notifications: notifications,
    OnMarkRead: func(id string) {
        components.Toast("Marked notification "+id+" as read", components.ToastInfo)
    },
    OnMarkAllRead: func() {
        components.Toast("All notifications marked as read", components.ToastSuccess)
    },
    OnClear: func() {
        components.Toast("Notifications cleared", components.ToastInfo)
    },
    OnNotificationClick: func(id string) {
        components.Toast("Clicked notification "+id, components.ToastInfo)
    },
})
```

3. Update LayoutProps.Header to include the new components:
```go
Header: components.HeaderProps{
    Title:              "Dashboard",
    NotificationCenter: notificationCenter,
    UserMenu:          userMenu,
    Actions: []components.HeaderAction{
        {Label: "Refresh", OnClick: func() { js.Global().Get("location").Call("reload") }},
    },
},
```

Place the userMenu and notificationCenter creation before the layout creation (before `layout = components.NewLayout(...)`).
  </action>
  <verify>cd example && go build ./app/... compiles without errors</verify>
  <done>Example app shows UserMenu avatar and NotificationCenter bell in header, clicking shows dropdowns with sample data</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Header components with User Menu and Notification Center</what-built>
  <how-to-verify>
    1. Build and run: `cd example && make dev` (or appropriate build command)
    2. Open http://localhost:8080 in browser
    3. Verify header displays:
       - Bell icon with notification count badge (should show "2" for unread)
       - User avatar on the right side
    4. Click bell icon:
       - Dropdown appears with notifications list
       - "Mark all read" link visible in header
       - Each notification shows title, message, time
       - "Clear all" visible in footer
    5. Click user avatar:
       - Dropdown appears with user info header (name + email)
       - Profile, Settings, Logout menu items visible
       - Logout item styled differently (danger/red)
    6. Click outside dropdowns to close them
    7. Click menu items and verify toast notifications appear
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./components/...` succeeds
- [ ] `cd example && go build ./app/...` succeeds
- [ ] Header displays NotificationCenter and UserMenu in correct positions
- [ ] Both dropdowns open/close correctly
- [ ] Notification badge shows correct unread count
- [ ] All menu items trigger appropriate callbacks
</verification>

<success_criteria>

- Header component extended with optional UserMenu and NotificationCenter slots
- Example app demonstrates both components with sample data
- Human verification confirms visual correctness and functionality
- Phase 1 complete - header has user menu and notification center
</success_criteria>

<output>
After completion, create `.planning/phases/01-header-components/01-02-SUMMARY.md`

Summary should note:
- Phase 1: Header Components complete
- Files created: user_menu.go, notification_center.go
- Files modified: header.go, layout.go, main.go
- Ready for Phase 2: Layout & Navigation
</output>
