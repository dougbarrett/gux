---
phase: 02-layout-navigation
plan: 01
type: execute
---

<objective>
Extend the existing Sidebar component with desktop collapse functionality (icons-only mode) and a global keyboard shortcut for toggling.

Purpose: Enable users to maximize content area by collapsing the sidebar to icons-only mode on desktop, with quick keyboard access.
Output: Enhanced Sidebar with collapse/expand state, toggle button, and Cmd/Ctrl+B keyboard shortcut.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-header-components/01-02-SUMMARY.md

# Key source files:
@components/sidebar.go
@components/layout.go
@example/app/main.go

**Tech stack available:** Go WASM, Tailwind CSS
**Established patterns:**
- CSS transform for sidebar slide (mobile)
- Props struct pattern for component config
- Functional options pattern (WithOnOpen, etc.)
- Global event listeners (Modal ESC, Combobox keyboard)

**From Phase 1:**
- Header has UserMenu and NotificationCenter integrated
- Display order: bell, avatar, then action buttons
- Layout uses Sidebar + Header composition
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend Sidebar with desktop collapse state</name>
  <files>components/sidebar.go</files>
  <action>
Add collapse functionality to the Sidebar component:

1. Add `isCollapsed bool` field to Sidebar struct
2. Add `OnCollapse func(isCollapsed bool)` to SidebarProps for callback
3. Create methods: `Collapse()`, `Expand()`, `ToggleCollapse()`, `IsCollapsed() bool`

4. Add collapse toggle button in sidebar header (visible on md+ screens):
   - Position: right side of header, before close button
   - Icon: chevron-left when expanded, chevron-right when collapsed
   - Class: `hidden md:block` to only show on desktop

5. Update sidebar width classes:
   - Expanded: `w-64` (existing)
   - Collapsed: `w-16` (icons-only)
   - Use CSS transition for smooth width change

6. Update nav items when collapsed:
   - Hide label text (use `hidden` class when collapsed)
   - Keep icon visible and centered
   - Add tooltip on hover showing label when collapsed

7. Update createNavItem to handle collapsed state:
   - When collapsed: icon centered, label hidden
   - When expanded: icon + label inline (existing)

Avoid adding localStorage persistence here - that belongs in Phase 4 (UX Polish).
  </action>
  <verify>
Run `go build ./...` from project root - no compile errors.
Visually verify in browser: sidebar has collapse button, clicking toggles between w-64 and w-16.
  </verify>
  <done>
- Sidebar has visible collapse toggle button on desktop
- Clicking toggle smoothly transitions between expanded (w-64) and collapsed (w-16)
- Icons remain visible when collapsed, labels hidden
- Nav items show tooltip with label on hover when collapsed
- Mobile behavior unchanged (still uses slide-in/out)
  </done>
</task>

<task type="auto">
  <name>Task 2: Add global keyboard shortcut for sidebar toggle</name>
  <files>components/sidebar.go, example/app/main.go</files>
  <action>
Add global keyboard shortcut to toggle sidebar collapse:

1. In sidebar.go, add method `RegisterKeyboardShortcut()`:
   - Add global keydown listener on document
   - Listen for Cmd+B (Mac) or Ctrl+B (Windows/Linux)
   - Check: `event.metaKey || event.ctrlKey` AND `event.key === "b"` (case-insensitive)
   - Call `event.preventDefault()` to prevent browser default
   - Call `ToggleCollapse()` when triggered
   - Store js.Func reference for cleanup

2. Add `UnregisterKeyboardShortcut()` method for cleanup

3. In example/app/main.go:
   - After creating layout, call `layout.Sidebar().RegisterKeyboardShortcut()`
   - This enables Cmd/Ctrl+B to toggle sidebar

Note: Use lowercase "b" check since event.key returns lowercase for letter keys.
  </action>
  <verify>
Run app in browser, press Cmd+B (Mac) or Ctrl+B (Windows) - sidebar toggles collapsed state.
Verify no browser default behavior (Ctrl+B is sometimes "bold" in rich text editors).
  </verify>
  <done>
- Cmd/Ctrl+B toggles sidebar collapse state globally
- Keyboard shortcut prevents browser default behavior
- Works on both Mac (Cmd) and Windows/Linux (Ctrl)
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Collapsible sidebar with desktop toggle button and Cmd/Ctrl+B keyboard shortcut</what-built>
  <how-to-verify>
    1. Run: `cd example && make run` (or your usual dev command)
    2. Visit: http://localhost:8080
    3. Desktop view (>768px):
       - Verify collapse button visible in sidebar header (chevron icon)
       - Click button: sidebar collapses to ~64px width with icons only
       - Hover nav items when collapsed: tooltip shows label
       - Click button again: sidebar expands back to full width
    4. Keyboard shortcut:
       - Press Cmd+B (Mac) or Ctrl+B (Windows/Linux)
       - Sidebar should toggle collapse state
       - No browser default behavior triggered
    5. Mobile view (<768px):
       - Collapse button should be hidden
       - Mobile hamburger menu behavior unchanged
       - Sidebar still slides in/out on mobile
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./...` succeeds from project root
- [ ] Sidebar collapse toggle works on desktop
- [ ] Cmd/Ctrl+B keyboard shortcut toggles sidebar
- [ ] Mobile sidebar behavior unchanged
- [ ] No TypeScript/compilation errors
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Sidebar collapses to icons-only mode on desktop
- Keyboard shortcut works globally
- Mobile behavior preserved
</success_criteria>

<output>
After completion, create `.planning/phases/02-layout-navigation/02-01-SUMMARY.md` following the summary template.
</output>
