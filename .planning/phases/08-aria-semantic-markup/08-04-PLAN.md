---
phase: 08-aria-semantic-markup
plan: 04
type: execute
domain: go-wasm
---

<objective>
Add complete ARIA widget patterns to Tabs, Combobox, and Accordion components.

Purpose: Enable screen reader users to understand widget structure and navigate complex controls.
Output: Three components with proper WAI-ARIA widget patterns including roles, states, and relationships.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-accessibility-audit/A11Y-AUDIT.md

# Source files to modify:
@components/tabs.go
@components/combobox.go
@components/accordion.go

**From Phase 7 Audit - Widget Issues:**
- Tabs: Missing all ARIA tab roles (tablist, tab, tabpanel), aria-selected, aria-controls
- Combobox: Missing complete ARIA combobox pattern
- Accordion: Missing aria-expanded, aria-controls

**WAI-ARIA Widget Patterns:**
- Tabs: role="tablist" on nav, role="tab" on buttons, role="tabpanel" on panels
  - Tabs: aria-selected, aria-controls pointing to panel
  - Panels: aria-labelledby pointing back to tab
- Combobox: role="combobox" on input, aria-expanded, aria-controls, aria-activedescendant
  - Listbox: role="listbox" on dropdown, role="option" on items
- Accordion: role="button" on headers, aria-expanded, aria-controls pointing to panel
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add complete ARIA tablist pattern to Tabs</name>
  <files>components/tabs.go</files>
  <action>
Update Tabs component with full WAI-ARIA tabs pattern:

1. Tab navigation container (tabNav):
   - Add `role="tablist"`
   - Add `aria-label="Tabs"` or support custom label via props

2. Each tab button:
   - Add `role="tab"`
   - Generate unique ID: `tab-{index}-{uuid}`
   - Add `aria-selected="true"` for active, `"false"` for inactive
   - Add `aria-controls={panel-id}` pointing to corresponding panel
   - Add `tabindex="0"` for active tab, `tabindex="-1"` for inactive (roving tabindex)

3. Each tab panel:
   - Add `role="tabpanel"`
   - Generate unique ID: `tabpanel-{index}-{uuid}`
   - Add `aria-labelledby={tab-id}` pointing back to its tab
   - Add `tabindex="0"` to make panel focusable

4. Update SetActive() to also update:
   - aria-selected on all tabs
   - tabindex on all tabs (roving tabindex pattern)

5. Store IDs in struct for cross-referencing

Pattern: Tabs use roving tabindex - only active tab is in tab order.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>Tabs has role="tablist", tabs have role="tab" with aria-selected and aria-controls, panels have role="tabpanel" with aria-labelledby</done>
</task>

<task type="auto">
  <name>Task 2: Add complete ARIA combobox pattern to Combobox</name>
  <files>components/combobox.go</files>
  <action>
Update Combobox component with full WAI-ARIA combobox pattern:

1. Input element:
   - Add `role="combobox"`
   - Add `aria-expanded="true"` when dropdown open, `"false"` when closed
   - Add `aria-haspopup="listbox"`
   - Add `aria-controls={listbox-id}` pointing to dropdown
   - Add `aria-activedescendant={selected-option-id}` when option highlighted
   - Add `aria-autocomplete="list"` (filters as you type)

2. Dropdown/listbox container:
   - Add `role="listbox"`
   - Generate unique ID: `combobox-listbox-{uuid}`
   - Add `aria-label="Options"` or derive from input label

3. Each option:
   - Add `role="option"`
   - Generate unique ID: `combobox-option-{index}-{uuid}`
   - Add `aria-selected="true"` for highlighted option, `"false"` for others

4. Update open/close logic:
   - Toggle aria-expanded on input
   - Clear aria-activedescendant when closed

5. Update highlight logic:
   - Update aria-selected on all options
   - Update aria-activedescendant on input to point to highlighted option

Pattern: Combobox uses activedescendant to indicate focus within listbox.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>Combobox input has role="combobox" with aria-expanded/controls/activedescendant, listbox has role="listbox", options have role="option" with aria-selected</done>
</task>

<task type="auto">
  <name>Task 3: Add ARIA expanded/controls to Accordion</name>
  <files>components/accordion.go</files>
  <action>
Update Accordion component with ARIA disclosure pattern:

1. Each accordion header/trigger button:
   - Ensure it's a button element (or has role="button")
   - Add `aria-expanded="true"` when panel open, `"false"` when closed
   - Add `aria-controls={panel-id}` pointing to content panel
   - Generate unique ID for button: `accordion-trigger-{index}-{uuid}`

2. Each accordion content panel:
   - Generate unique ID: `accordion-panel-{index}-{uuid}`
   - Add `aria-labelledby={trigger-id}` pointing back to trigger button
   - Consider `role="region"` if content is significant (optional)

3. Update toggle logic:
   - Toggle aria-expanded on trigger button when panel state changes

4. Optional - Accordion container:
   - Consider adding a heading structure or aria-label for the accordion group

Pattern: Accordion uses disclosure pattern - each section is independently expandable.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>Accordion triggers have aria-expanded and aria-controls, panels have aria-labelledby</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd example && make build` succeeds without errors
- [ ] Tabs: tablist/tab/tabpanel roles with proper aria attributes
- [ ] Combobox: combobox/listbox/option roles with expanded/activedescendant
- [ ] Accordion: aria-expanded and aria-controls on triggers
- [ ] All ID references are unique and properly cross-linked
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No build errors
- Complex widgets are navigable and understandable by screen readers
</success_criteria>

<output>
After completion, create `.planning/phases/08-aria-semantic-markup/08-04-SUMMARY.md`
</output>
