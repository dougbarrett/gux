---
phase: 08-aria-semantic-markup
plan: 06
type: execute
domain: go-wasm
---

<objective>
Add complex ARIA patterns to DatePicker and Table components.

Purpose: Enable screen reader users to navigate date selection grids and understand table structure.
Output: DatePicker with combobox+grid pattern, Table with proper header associations and sort announcements.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-accessibility-audit/A11Y-AUDIT.md

# Source files to modify:
@components/datepicker.go
@components/table.go

**From Phase 7 Audit - Complex Widget Issues:**
- DatePicker: Missing complete combobox/grid pattern (9 gaps total)
- Table: Missing scope="col" on headers, aria-sort for sortable columns

**WAI-ARIA Patterns:**
- DatePicker: Input as combobox, calendar as grid with role="grid", days as gridcell
- Table: scope="col" on th, aria-sort="ascending"/"descending"/"none" on sortable columns
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add ARIA combobox and grid pattern to DatePicker</name>
  <files>components/datepicker.go</files>
  <action>
Update DatePicker with combobox + date grid pattern:

**Input element:**
1. Add `role="combobox"`
2. Add `aria-haspopup="dialog"` (calendar opens as dialog-like popup)
3. Add `aria-expanded="false"` initially, "true" when calendar open
4. Add `aria-controls={calendar-id}` pointing to calendar container
5. Add `aria-label` or ensure label association via for/id

**Calendar container (when open):**
1. Add `role="dialog"` or `role="application"` (contains interactive grid)
2. Generate unique ID: `datepicker-calendar-{uuid}`
3. Add `aria-modal="true"` if it traps focus
4. Add `aria-label="Choose date"` or similar

**Calendar grid:**
1. Table element: Add `role="grid"`
2. Header row with weekday names:
   - Row: `role="row"`
   - Cells: `role="columnheader"` with abbreviated day names
3. Day cells:
   - Row: `role="row"`
   - Each day: `role="gridcell"`
   - Add `aria-selected="true"` on selected date
   - Add `aria-disabled="true"` on disabled dates
   - Add `aria-current="date"` on today's date

**Navigation buttons (prev/next month):**
1. Add `aria-label="Previous month"` and `aria-label="Next month"`
2. Ensure they're focusable buttons

**Month/year display:**
1. Use a live region or update announcements when month changes
2. Consider `aria-live="polite"` on month display

Pattern: DatePicker combines combobox trigger with grid-based calendar.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>DatePicker input has combobox role with expanded state, calendar has grid/gridcell roles with selected/disabled states, navigation has labels</done>
</task>

<task type="auto">
  <name>Task 2: Add scope and aria-sort to Table headers</name>
  <files>components/table.go</files>
  <action>
Update Table component for accessible headers and sorting:

**Table element:**
1. Ensure table uses semantic `table` element (not divs)
2. Add `aria-label` or `aria-labelledby` if table has a caption/title
3. If table has row selection, add `aria-multiselectable="true"`

**Header cells (th elements):**
1. Add `scope="col"` to all column headers
2. For sortable columns:
   - Add `aria-sort="none"` initially (sortable but not sorted)
   - Add `aria-sort="ascending"` when sorted ascending
   - Add `aria-sort="descending"` when sorted descending
3. Sort button/trigger within header:
   - Ensure it's a button or has role="button"
   - Add `aria-label` describing action: "Sort by {column} ascending"

**Update sort logic:**
1. When column is sorted, update `aria-sort` attribute:
   - Remove aria-sort from previously sorted column (or set to "none")
   - Set appropriate value on newly sorted column
2. Consider announcing sort change via live region (optional)

**Row selection (if applicable):**
1. Selectable rows should have `aria-selected="true"/"false"`
2. Selection checkbox should have proper label

**Empty state:**
1. If table is empty, consider `aria-label` describing empty state
2. Or use a live region to announce when data changes

Pattern: scope="col" associates data cells with headers; aria-sort indicates sort state.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>Table headers have scope="col", sortable headers have aria-sort with correct values, table has proper labeling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd example && make build` succeeds without errors
- [ ] DatePicker input has role="combobox" with aria-expanded
- [ ] DatePicker calendar has role="grid" with proper gridcell structure
- [ ] Table headers have scope="col"
- [ ] Sortable columns have aria-sort with correct value
- [ ] Interactive elements have proper aria-labels
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No build errors
- Complex data widgets are navigable by screen readers
</success_criteria>

<output>
After completion, create `.planning/phases/08-aria-semantic-markup/08-06-SUMMARY.md`

**Phase 8 Complete Criteria:**
When 08-06 is done, Phase 8 (ARIA & Semantic Markup) is complete.
Ready for Phase 9: Keyboard Navigation.
</output>
