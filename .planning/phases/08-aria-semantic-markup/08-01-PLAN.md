---
phase: 08-aria-semantic-markup
plan: 01
type: execute
domain: go-wasm
---

<objective>
Add ARIA dialog patterns to Modal, ConfirmDialog, and CommandPalette components.

Purpose: Enable screen reader users to understand dialog context and navigate dialog content.
Output: Three components with proper dialog/alertdialog roles, aria-modal, aria-labelledby, and listbox patterns.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-accessibility-audit/A11Y-AUDIT.md

# Source files to modify:
@components/modal.go
@components/confirm_dialog.go
@components/command_palette.go

**From Phase 7 Audit - Dialog Issues:**
- Modal: Missing role="dialog", aria-modal="true", aria-labelledby pointing to title
- ConfirmDialog: Should use role="alertdialog" (wraps Modal), needs aria-describedby for message
- CommandPalette: Missing role="dialog", needs listbox/option pattern for results

**WAI-ARIA Patterns:**
- Dialog: role="dialog", aria-modal="true", aria-labelledby={title-id}
- Alertdialog: role="alertdialog", aria-describedby={message-id}, aria-labelledby={title-id}
- Listbox in dialog: role="listbox" on container, role="option" on items, aria-activedescendant
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add ARIA dialog pattern to Modal</name>
  <files>components/modal.go</files>
  <action>
Update Modal component:
1. Generate unique ID for title: `modal-title-{uuid}` using crypto.randomUUID()
2. Add to modal container div:
   - `role="dialog"`
   - `aria-modal="true"`
   - `aria-labelledby={title-id}` (only if Title is provided)
3. Add `id={title-id}` to the h3 title element
4. Add `aria-label="Close"` to close button (currently just has Ã— symbol)
5. Store title ID on Modal struct for potential external reference

Pattern from audit: Modal lacks role="dialog" and focus management attributes.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>Modal has role="dialog", aria-modal="true", aria-labelledby pointing to title, close button has aria-label</done>
</task>

<task type="auto">
  <name>Task 2: Add ARIA alertdialog pattern to ConfirmDialog</name>
  <files>components/confirm_dialog.go</files>
  <action>
Update ConfirmDialog component:
1. Generate unique IDs: `confirm-title-{uuid}` and `confirm-desc-{uuid}`
2. After creating the Modal, access its modal container and override:
   - Set `role="alertdialog"` (overrides dialog)
   - Set `aria-describedby={desc-id}` pointing to message
3. Add `id={desc-id}` to the message paragraph element
4. Ensure aria-labelledby from Modal still points to title

Note: ConfirmDialog wraps Modal internally. Need to access the modal's inner container after creation to add alertdialog-specific attributes. May need to expose a method on Modal or access via Element().

Pattern: Alertdialog is for important messages requiring immediate response.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>ConfirmDialog has role="alertdialog", aria-describedby pointing to message, aria-labelledby pointing to title</done>
</task>

<task type="auto">
  <name>Task 3: Add ARIA dialog and listbox pattern to CommandPalette</name>
  <files>components/command_palette.go</files>
  <action>
Update CommandPalette component:
1. Add to overlay/container:
   - `role="dialog"`
   - `aria-modal="true"`
   - `aria-label="Command palette"` (no visible title to reference)
2. Add to results container:
   - `role="listbox"`
   - `aria-label="Commands"`
   - Generate unique ID for listbox
3. Add to each command item:
   - `role="option"`
   - `aria-selected="true"` on highlighted item, "false" on others
   - Unique `id` for each option
4. Add to search input:
   - `aria-controls={listbox-id}` pointing to results container
   - `aria-activedescendant={selected-option-id}` updated on highlight change
   - `aria-autocomplete="list"`
5. Update highlight logic to also update aria-selected and aria-activedescendant

Pattern: Combobox-like pattern with listbox results.
  </action>
  <verify>Build passes: `cd example && make build` succeeds without errors</verify>
  <done>CommandPalette has dialog role, results have listbox/option pattern, input has aria-controls and aria-activedescendant</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd example && make build` succeeds without errors
- [ ] Modal has role="dialog", aria-modal="true"
- [ ] ConfirmDialog has role="alertdialog", aria-describedby
- [ ] CommandPalette has dialog role and listbox pattern
- [ ] All ID references are unique (use crypto.randomUUID)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No build errors
- Dialog components announce properly to screen readers
</success_criteria>

<output>
After completion, create `.planning/phases/08-aria-semantic-markup/08-01-SUMMARY.md`
</output>
